<!DOCTYPE html>
<html lang="en">
<head>
  <%- include('./partials/head') %>
  <title>Blog</title>
</head>
<body>
  <%- include('./partials/nav') %>

  <div class="container mt-4">
    <h1><%= blog.title %></h1>

    <img src="<%= blog.coverImageURL %>" class="img-fluid mb-3" width="100px"/>

    <p class="mt-3" style="white-space: pre-wrap; word-wrap: break-word;">
      <%= blog.body %>
    </p>
  </div>

  <div class="container mt-4 d-flex align-items-center gap-2">
    <img src="<%= blog.createdBy.profileimageurl %>" width="50" height="50" style="border-radius:50%" />
    <strong><%= blog.createdBy.fullname %></strong>
  </div>

  <div class="container mt-3">
    <h3>Comments (<%= comments.length %>)</h3>

    <% if (locals.user) { %>
      <form action="/blog/comment/<%= blog._id %>" method="post" class="mb-3">
        <div class="input-group">
          <input
            type="text"
            name="content"
            class="form-control"
            placeholder="Enter your comment"
            required
          />
          <button class="btn btn-primary" type="submit">Add</button>
        </div>
      </form>
    <% } %>

    <div>
      <% comments.forEach(comment => { %>
        <div class="border rounded p-2 mb-2">
          <div class="d-flex align-items-center gap-2 mb-1">
            <img src="<%= comment.createdBy.profileimageurl %>" width="40" height="40" style="border-radius:50%" />
            <strong><%= comment.createdBy.fullname %></strong>
          </div>

          <p style="white-space: pre-wrap; word-wrap: break-word;">
            <%= comment.content %>
          </p>
        </div>
      <% }) %>
    </div>
  </div>

  <%- include('./partials/scripts') %>
</body>
</html>
